 const updateGlobalState = useMemo(
    () => (value) => {
      setRows((prevRows) => {
        const updatedRows = [...prevRows];
        if (updatedRows[index]) {
          const targetRow = { ...updatedRows[index] };
          targetRow[column.key] = value;

          if (column.key === 'aggOutStand' || column.key === 'aggSecurities') {
            const out = parseFloat(targetRow.aggOutStand) || 0;
            const sec = parseFloat(targetRow.aggSecurities) || 0;
            targetRow.netShortfall = (out - sec).toFixed(2);
          }
          updatedRows[index] = targetRow;
          return updatedRows;
        }
        return prevRows;
      });
    },
    [index, column.key, setRows]
  );
